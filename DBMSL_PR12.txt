package mongodb_connection;

import org.bson.Document;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;
import com.mongodb.client.MongoClient;
import com.mongodb.client.MongoClients;
import com.mongodb.client.model.Filters;
import com.mongodb.client.model.Updates;

public class Demo {

	public static void main(String[] args) {
		String connectionString = "mongodb://localhost:27017";
		MongoClient mongoClient = MongoClients.create(connectionString);
		System.out.println("Connection established successfully!");
		
		MongoDatabase database = mongoClient.getDatabase("PICT");
		MongoCollection<Document> collection = database.getCollection("student");
		
		// Create
		Document doc1 = new Document("rollno", 1).append("name", "Kedar").append("marks", 96);
		collection.insertOne(doc1);
		System.out.println("Inserted successfully!");
		
		// Read
		System.out.println("Documents in collection: ");
		for(Document doc: collection.find()) {
			System.out.println(doc.toJson());
		}
		
		// Update
		collection.updateOne(Filters.eq("name", "Tanishka"), Updates.set("marks", 94));
		System.out.println("Updated successfully!");
		
		// Delete
		collection.deleteOne(Filters.eq("name", "Tanishka"));
		System.out.println("Deleted successfully!");
	}
}
